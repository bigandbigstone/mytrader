def on_orderflow(模拟交易指令流):
    # 策略订单成交高度撮合算法，要接入模拟交易指令流
    # 高度降低到0，即为成交
    for 模拟交易指令 in 模拟交易指令流:
        交易指令类型 = 模拟交易指令.指令类型
        订单类型 = 模拟交易指令.订单类型
        价位 = 模拟交易指令.订单队列价位
        变化量 = 模拟交易指令.变化量
        if 交易指令类型 == "新增":
            # 新增订单用于订单创建时的高度修正
            if 订单类型 == "买单":
                更新买单新增高度
            else:
                更新卖单新增高度
        elif 交易指令类型 == "撮合" or "取消"
            # 订单取消，高度降低
            # 订单撮合，高度降低
            orders = 获取所有策略订单
            for order in orders:
                if order.Type = 订单类型 and order.Price = 价位:
                # 伪代码中使用了遍历，但实际上order符合判断是以数据库查询的形式实现的
                    order.Height -= 变化量
                    if order.Height <= 0:
                        成交(order)
                        # 成交判断的实现也是基于数据库操作的
                        更新策略订单
                        更新用户持仓、资金情况
